# 标签配置文件
# Semantune 标签生成系统配置

# 标签白名单
allowed_labels:
  mood:
    - Happy
    - Sad
    - Romantic
    - Peaceful
    - Dreamy
    - Dark
    - Melancholic
    - Hopeful
    - Nostalgic
    - Mysterious
    - Playful
    - Warm
  energy:
    - Low
    - Medium
    - High
  genre:
    - Pop
    - Rock
    - Hip-Hop
    - R&B
    - Electronic
    - Folk
    - Jazz
    - Classical
    - Metal
    - Indie
    - Soundtrack
    - Ambient
    - World
    - None
  style:
    - Ballad
    - Acoustic
    - Orchestral
    - Cinematic
    - Lo-fi
    - Synthwave
    - Trap
    - House
    - Techno
    - EDM
    - Alternative
    - Post-rock
    - Hard Rock
    - Soft Rock
    - Dream Pop
    - Minimalist
    - Retro
    - Modern
    - Punk
    - City Pop
  scene:
    - Sleep
    - Study
    - Relax
    - Focus
    - Driving
    - Workout
    - Running
    - Party
    - Background
    - Travel
    - Morning
    - Night
    - Meditation
    - Gaming
  region:
    - Chinese
    - Taiwanese
    - Hong Kong
    - Japanese
    - Korean
    - Western
    - Other
  culture:
    - Anime
    - Game
    - Film
    - TV
    - Idol
    - Vocaloid
    - None
  language:
    - Chinese
    - Japanese
    - Korean
    - English
    - Instrumental
    - Other

# 自定义提示词模板（支持歌词）
prompt_template: |
  你是专业音乐标签系统。请根据歌曲信息输出严格符合规则的JSON标签。

  【强制执行规则】
  1. 只能使用白名单中的标签，不得创造新标签。
  2. 每个标签必须是白名单中的单个完整词条，不允许组合词或拼接词（例如禁止 "Dark Melancholic"）。
  3. 严格遵守每个字段的数量限制。
  4. 如果最合适的语义标签不在白名单中，必须用最接近的合法标签替换，而不是输出非法标签。
  5. 如果不确定，请选择更少标签而不是猜测。
  6. language 判断原则：除非 100% 确定是纯音乐（仅乐器演奏、无人声、无唱词），否则不得标记为 "Instrumental"。
  7. genre 表示一级商业流派；style 表示子风格、质感或制作风格。若有冲突，请保持 genre 更宽泛。
  8. 在输出前，请逐字段检查是否违反以上规则，并在发现问题时自动修正。
  9. 只输出 JSON，不要任何解释文字。

  【明确禁止标签（即使在训练数据中很常见，也绝对禁止输出）】

  Mood 禁止：
  - Epic, Energetic, Upbeat, Groovy, Chill, Emotional

  Genre 禁止：
  - J-Pop, K-Pop, C-Pop, J-Rock, K-Rock

  如果原始语义属于上述标签，必须按以下方式表达：
  - Epic → 使用 energy=High + style=Cinematic/Orchestral + mood=Hopeful/Dark/Mysterious
  - J-Pop/K-Pop/C-Pop → 使用 region + genre=Pop + 可选 style=City Pop

  【高优先级纠错规则 - 必须优先执行】

  1. 判断 language 是否为 Instrumental 时，严格遵循以下标准：
     - 仅有纯音乐（无任何人声、哼唱、Vocaloid）才能标记为 Instrumental
     - 包含歌词或人声的歌曲，language 绝对不得为 Instrumental
     - 如果无法确定是否有人声，默认假设有人声（特别是流行/动漫/游戏音乐）

  2. 特殊类型歌曲的 language 判断规则：
     - Vocaloid 作品（初音ミク、巡音ルカ、GUMI 等）→ language 必须为实际语言，绝不能是 Instrumental
     - 所有 OST（动漫/游戏/电影/电视剧）→ 默认为实际语言，除非明确标注为背景音乐(BGM)/纯音乐
     - 日本/韩国的流行/动漫/游戏音乐 → 强烈偏向有人声，language 应为 Japanese/Korean
     - 包含人声的电子音乐（如 Daft Punk）→ language 为实际语言，不是 Instrumental
     - 任何包含演唱、说唱、合声的歌曲 → language 不能是 Instrumental

  3. OST / Anime / Game 类型的 genre/classification 与 language 是独立维度：
     - culture=Anime/Game/Film/TV 不能推导出 language=Instrumental
     - 是否标记为 Instrumental 仅取决于：是否包含任何形式的人声
     - 大多数动漫/游戏 OP/ED/插入歌都有歌词，language 必须标注实际语言
     - 只有明确标注为 BGM/Soundtrack/Background Music 的纯音乐才能标记为 Instrumental

  4. 出现冲突时的优先级（从高到低）：
     - 第一优先级：language 正确性（有人声绝不能标 Instrumental）
     - 第二优先级：genre/style 合理性
     - 第三优先级：mood 精细度

  5. 关键判断原则：
     - 如果歌曲标题包含以下词汇，倾向于有人声：歌、曲、主题歌、主题曲、OP、ED、插入歌、FLAGS
     - 如果是艺术家的知名歌曲（如 Daft Punk 的 Get Lucky），假设有人声
     - 只有明确知道是纯音乐的情况下才标记为 Instrumental
     - culture 为 Game/Anime/Film/TV 的歌曲，除非标题明确写 BGM/Background/Piano Version，否则假设有人声

  【歌曲信息】
  标题: {title}
  艺术家: {artist}
  专辑: {album}
  歌词: {lyrics}

  【标签白名单】

  mood (选择 1–3 个，按重要性排序):
  Happy, Sad, Romantic, Peaceful, Dreamy, Dark,
  Melancholic, Hopeful, Nostalgic, Mysterious, Playful, Warm

  energy (选择 1 个):
  Low, Medium, High

  genre (选择 1–2 个):
  Pop, Rock, Hip-Hop, R&B, Electronic, Folk,
  Jazz, Classical, Metal, Indie, Soundtrack, Ambient, World, None

  style (选择 0–3 个):
  Ballad, Acoustic, Orchestral, Cinematic, Lo-fi,
  Synthwave, Trap, House, Techno, EDM,
  Alternative, Post-rock, Hard Rock, Soft Rock,
  Dream Pop, Minimalist, Retro, Modern, Punk, City Pop

  scene (选择 0–2 个):
  Sleep, Study, Relax, Focus, Driving, Workout,
  Running, Party, Background, Travel,
  Morning, Night, Meditation, Gaming

  region (选择 1 个):
  Chinese, Taiwanese, Hong Kong, Japanese, Korean, Western, Other

  culture (选择 1 个):
  Anime, Film, TV, Game, Idol, Vocaloid, None

  language (选择 1 个):
  Chinese, Japanese, Korean, English, Instrumental, Other

  【输出格式】
  ```json
  {{
    "mood": ["..."],
    "energy": "...",
    "genre": ["..."],
    "style": ["..."],
    "scene": ["..."],
    "region": "...",
    "culture": "...",
    "language": "...",
    "confidence": 0.00
  }}
  ```

# API 调用配置
api:
  timeout: 60
  max_tokens: 1024
  temperature: 0.2
  top_p: 0.9
  retry_delay: 1
  max_retries: 3
  retry_backoff: 2
